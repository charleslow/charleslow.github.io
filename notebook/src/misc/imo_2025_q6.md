# IMO 2025 Q6

> **Q6**: Consider a 2025×2025 grid of unit squares. Matilda wishes to place on the grid some rectangular tiles, possibly of different sizes, such that each side of every tile lies on a grid line and every unit square is covered by at most one tile.
> 
> Determine the minimum number of tiles Matilda needs to place so that each row and each column of the grid has exactly one unit square that is not covered by any tile.

This is an interesting problem with a surprising solution. I have an interactive visualization at [https://charleslow.github.io/grid_visualization](https://charleslow.github.io/grid_visualization) to explore this problem.

## Initial Attempt

The first instinct is to take an approach like below. That is, we observe that using single row / column rectangular tiles is sufficient to tile the grid. Hence the solution uses $2(n-1)$ tiles if the grid is $n \times n$. I thought this was the solution initially, and tried to prove it but failed.

## Solution

Let's draw a vertical and horizontal line from each uncovered square (call it a "<<gap>>"). Observe there may be `2-4` such lines emanating in the NSEW directions from each gap. Overall, there would be $4n-4$ such lines ($-4$ because there is no line at the first & last row / column). Let's call each of these lines a "<<half-line>>". 

Since each `row, col` pair has one gap, we are assured that a tiling that covers all the half-lines satisfies Matilda (as it will then cover every row and column, except for the gaps).

Now the question is, how quickly can we cover the $4n-4$ half-lines with a minimal number of tiles? In other words, how many half-lines can we clear with each tile we introduce?

Now, it is tricky to analyze the number of lines we clear on each turn, because it depends on the preceding steps. For example, if we had cleared all but one remaining tile on each half-line (show example), then the next step can clear a large number of half-lines. It is hard to reason across multiple turns.

So an important observation:
> **Lemma 1**: The number of gaps that each tile *touches* is an upper bound for the number of half-lines cleared after $k$ steps. 
>
> **Proof**. This is quite self-explanatory, as touching a gap is pre-requisite to clearing a half-line that emanates from that side of the gap.

Lemma 1 shifts the analysis from clearing half-lines to analyzing (and maximizing) the number of gaps we touch with every tile we introduce. The number of gaps touched per tile is easier to reason about, as we shall see. We will make the upper bound an equality later on with a specific strategy.

> **Lemma 2**: The number of gaps touched per tile is capped at `4`.
>
> **Proof**. This is also not hard to see. Imagine a tile bounded on all sides by gaps. Since there can only be one gap per row and column, the tile cannot be touching more than one gap per side. Since the tile only has 4 sides, it can only touch up to 4 gaps.

To get a minimal tiling, we wish to maximize the number of "<<4-tiles>>" (i.e. tiles touching `4` holes). This may be done by minimizing the size for a 4-tile at $2 \times 2$. One such configuration is shown below.

<figure style="max-width:320px;margin:1.25rem auto;padding:0 1.5rem;text-align:center;">
  <img src="../images/imo_2025_q6/optimal_4_tile.png" alt="Optimal 4-tile configuration" style="width:100%;height:auto;border:1px solid #ccc;border-radius:6px;box-shadow:0 2px 4px rgba(0,0,0,0.08);" />
  <figcaption style="font-size:0.85rem;color:#555;margin-top:0.4rem;">Figure: A minimal 2×2 tile touching four gaps.</figcaption>
</figure>

A naive solution is to just replicate this pattern repeatedly along the diagonal, like so. Since we take `5` tiles to tile each $4 \times 4$ mini-grid, this gives us $\frac{5n}{4} + 2(\frac{n}{4}-1)$ tiles for a $n \times n$ grid. For e.g. for a $12 \times 12$ grid shown, the naive solution gives us $2(12-1) = 22$, but our new strategy gives $5\times3 + 2(3-1) = 19$.

So we already have a lower number than the original naive solution, but can we do better?

<figure style="max-width:320px;margin:1.25rem auto;padding:0 1.5rem;text-align:center;">
  <img src="../images/imo_2025_q6/repeated_optimal_4_tile.png" alt="Optimal 4-tile configuration" style="width:100%;height:auto;border:1px solid #ccc;border-radius:6px;box-shadow:0 2px 4px rgba(0,0,0,0.08);" />
  <figcaption style="font-size:0.85rem;color:#555;margin-top:0.4rem;">Figure: Repeat across diagonal.</figcaption>
</figure>

Staring at the figure above, we can see that putting all our $4 \times 4$ mini-grids along the diagonal is to commit the same mistake as our original naive solution. 

More specifically, if we treat each $4 \times 4$ mini-grid as a single square, we can see that the problem reduces once again to the original problem, except that the number of rows and columns shrink by a factor of `4`. Therefore, we can squeeze more `4-tiles` out by using the same strategy (except that we are now treating each $4 \times 4$ mini-grid as an atomic square). 

An example using $16 \times 16$ is shown:
<figure style="max-width:320px;margin:1.25rem auto;padding:0 1.5rem;text-align:center;">
  <img src="../images/imo_2025_q6/optimal_16_by_16.png" alt="Optimal 16x16 configuration" style="width:100%;height:auto;border:1px solid #ccc;border-radius:6px;box-shadow:0 2px 4px rgba(0,0,0,0.08);" />
  <figcaption style="font-size:0.85rem;color:#555;margin-top:0.4rem;">Figure: Optimal 16 x 16 tiling.</figcaption>
</figure>

We can recursively use this strategy for grid sizes that are powers of $4$. What if our grid is not a power of $4$? We can split it up into a series of grids that are powers of $4$.

Suppose we have a grid of size $n \times n$.
- For a grid 


The aim is to now show that the optimal solution will comprise tiles that either touch `2` or `4` gaps (and maximize the number touching `4` gaps). Before we go further, we first need to get rid of the pesky case of touching `3` tiles.

> **Lemma 3**. The minimal tiling will not have any tiles touching `3` gaps.
>
> **Proof**. For a tile to touch `3` gaps, it has to be bounded on 1 side by the grid boundary. It also has to have a minimal size of $2 \times 2$. Furthermore, there will exist one row or column that still requires a gap (show example).


